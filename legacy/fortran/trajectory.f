C     ******************************************************************
C     * FORTRAN-IV BALLISTIC TRAJECTORY CALCULATOR                    *
C     * COMPUTES PROJECTILE RANGE USING CLASSICAL MECHANICS           *
C     * AUTHENTIC 1957 FIXED-FORMAT SYNTAX (COLUMNS 1-72)             *
C     ******************************************************************
C
C     PROGRAM: TRAJECTORY
C     AUTHOR:  IBM-7090-MAINFRAME
C     DATE:    1957-RESURRECTED-2024
C
      PROGRAM TRAJEC
      IMPLICIT NONE
      
C     VARIABLE DECLARATIONS
      REAL VELOC, ANGLE, GRAV
      REAL RANGE, ANGRD, SINVAL
      REAL PI
      CHARACTER*20 ARG1, ARG2, ARG3
      INTEGER IARGC, NUMARG
      INTEGER IOS1, IOS2, IOS3
      
C     CONSTANTS
      PARAMETER (PI = 3.14159265)
      
C     GET NUMBER OF COMMAND LINE ARGUMENTS
      NUMARG = IARGC()
      
C     VALIDATE ARGUMENT COUNT
      IF (NUMARG .LT. 3) THEN
          WRITE(0,*) 'ERROR: INSUFFICIENT ARGUMENTS'
          CALL EXIT(1)
      END IF
      
C     READ COMMAND LINE ARGUMENTS
      CALL GETARG(1, ARG1)
      CALL GETARG(2, ARG2)
      CALL GETARG(3, ARG3)
      
C     CONVERT STRING ARGUMENTS TO NUMERIC VALUES
      READ(ARG1, *, IOSTAT=IOS1) VELOC
      READ(ARG2, *, IOSTAT=IOS2) ANGLE
      READ(ARG3, *, IOSTAT=IOS3) GRAV
      
C     CHECK FOR CONVERSION ERRORS
      IF (IOS1 .NE. 0 .OR. IOS2 .NE. 0 .OR. IOS3 .NE. 0) THEN
          WRITE(0,*) 'ERROR: NON-NUMERIC INPUT DETECTED'
          CALL EXIT(1)
      END IF
      
C     VALIDATE INPUT RANGES
      IF (VELOC .LE. 0.0) THEN
          WRITE(0,*) 'ERROR: INVALID VELOCITY'
          CALL EXIT(1)
      END IF
      
      IF (ANGLE .LE. 0.0 .OR. ANGLE .GE. 90.0) THEN
          WRITE(0,*) 'ERROR: INVALID ANGLE'
          CALL EXIT(1)
      END IF
      
      IF (GRAV .LE. 0.0) THEN
          WRITE(0,*) 'ERROR: INVALID GRAVITY'
          CALL EXIT(1)
      END IF
      
C     CONVERT ANGLE FROM DEGREES TO RADIANS
      ANGRD = ANGLE * PI / 180.0
      
C     CALCULATE SIN(2*THETA)
      SINVAL = SIN(2.0 * ANGRD)
      
C     CALCULATE RANGE: R = (V^2 * SIN(2*THETA)) / G
      RANGE = (VELOC * VELOC * SINVAL) / GRAV
      
C     OUTPUT RESULT IN UNIVERSAL FORMAT
      WRITE(6,100) RANGE
  100 FORMAT('RESULT: ',F10.2)
      
C     TERMINATE WITH SUCCESS CODE
      CALL EXIT(0)
      
      END
